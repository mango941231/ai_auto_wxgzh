analyze_topic:
  name: "analyze_topic"
  description: |
    解析话题{topic}，确定文章的核心要点和结构。
    生成一份包含文章大纲和核心要点的报告。
    注意：
    1. 关于文章标题的日期处理：
       - 严格检查：{topic}中是否已包含具体年份或日期信息
       - 如果包含，则保留该日期信息在文章标题中
       - 如果不包含，则文章标题必须完全不包含任何年份或日期信息
       - 禁止自行添加当前年份或任何其他年份到文章标题中
    2. 内容中的日期处理：
       - 如果{topic}包含日期，在内容中使用该日期
       - 如果不包含，对于需要提及年份的内容，使用"20xx年"格式
  agent: researcher
  expected_output: 文章正文（标准Markdown格式）

write_content:
  name: "write_content"
  description: |
    基于生成的文章大纲和AIPy搜索获取的最新数据，撰写一篇高质量的微信公众号文章。

    首先，使用工具 aipy_search_tool 搜索关于{topic}的最新信息、数据和趋势。
    然后，将搜索结果与文章大纲结合，确保文章包含最新的事实、数据和时间点。

    确保文章内容准确、逻辑清晰、语言流畅，并具有独到的见解。
    文章标题为{platform}|{topic}。

    特别注意：
    1. 引用最新的数据和统计信息，包括具体的日期
    2. 提及当前的趋势和发展
    3. 引用权威来源的最新观点
    4. 日期处理要求：
       - 严格检查并替换所有"20xx年"格式的占位符日期
       - 如果搜索结果中有具体日期，使用搜索结果中的实际日期替换占位符
       - 如果搜索结果中没有具体日期，使用以下替代表述：
         * "近期"、"最近"、"当前"等时间表述
         * "据最新数据显示"、"根据最新研究"等表述
         * 完全省略时间表述，直接陈述事实
       - 绝对不允许在最终文章中出现"20xx年"格式的占位符

    在提交最终文章前，请再次检查并确保没有任何"20xx年"格式的日期出现在文章中。
  agent: writer
  expected_output: 文章标题 + 文章正文（标准Markdown格式）

audit_content:
  name: "audit_content"
  description: |
    对生成的文章进行全面质量审核，包括标题（格式为{platform}|{topic}）、内容、语法等方面。
    请检查文章是否与热门话题紧密相关，并具有独到的见解，发现文章中的错误和不足之处，生成修改后的文章。
  agent: auditor
  expected_output: 修改后的文章（标准Markdown格式）

design_content:
  name: "design_content"
  description: |
    将前置任务生成的文章转化为精美的微信公众号排版，提升阅读体验和视觉吸引力。
    请严格遵循以下要求：  
    - 仅对文章进行排版设计和风格优化，不得生成新的文章内容。  
    - 不得过多删减原文章内容，保持原内容的完整性和核心信息。
  agent: designer
  context: ["write_content", "audit_content"]
  expected_output: 排版设计后的文章（HTML格式）

template_content:
  name: "template_content"
  description: |
    # HTML内容适配任务
    ## 任务目标
    使用工具 read_template_tool 读取本地HTML模板，将前置任务生成的文章内容适配填充到读取的HTML模板中，保持视觉效果和风格不变，同时确保内容呈现自然流畅。

    ## 执行步骤
    1. 首先使用 read_template_tool 读取HTML模板
    2. 分析模板的结构、样式和布局特点
    3. 获取前置任务生成的文章内容
    4. 将新内容按照模板结构进行适配填充
    5. 确保最终输出是基于原模板的HTML，保持视觉效果和风格不变

    ## 具体要求
    - 分析HTML模板的结构、样式和布局特点
    - 识别所有内容占位区域（标题、副标题、正文段落、引用、列表等）
    - 将新文章内容按照原模板的结构和布局规则填充：
      * 保持<section>标签的布局结构和内联样式不变
      * 保持原有的视觉层次、色彩方案和排版风格
      * 保持原有的卡片式布局、圆角和阴影效果
      * 保持SVG动画元素和交互特性

    - 内容适配原则：
      * 标题替换标题、段落替换段落、列表替换列表
      * 当新内容比原模板内容长或短时，合理调整，不破坏布局
      * 保持原有的强调部分（粗体、斜体、高亮等）应用于新内容的相应部分
      * 保持图片位置

    - 严格限制：
      * 不添加新的style标签或外部CSS
      * 不改变原有的色彩方案（限制在三种色系内）
      * 不修改模板的整体视觉效果和布局结构
  agent: templater
  context: ["write_content", "audit_content"]
  expected_output: 填充新内容但保持原有视觉风格的文章（HTML格式）
